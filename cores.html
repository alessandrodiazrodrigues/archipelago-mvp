<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seletor de Cores - Archipelago Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #ffffff;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
            color: #60a5fa;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .section {
            background: #1a1f2e;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .section h2 {
            color: #60a5fa;
            margin-bottom: 20px;
            font-size: 20px;
            border-bottom: 2px solid #334155;
            padding-bottom: 10px;
        }

        .item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.2s;
        }

        .item:hover {
            background: rgba(96, 165, 250, 0.1);
        }

        .item-name {
            flex: 1;
            font-size: 14px;
            color: #e2e8f0;
        }

        .color-box {
            width: 50px;
            height: 35px;
            border-radius: 6px;
            border: 2px solid rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: rgba(255,255,255,0.8);
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .color-selector-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-select {
            padding: 8px 12px;
            background: #0f172a;
            color: #ffffff;
            border: 1px solid #334155;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            min-width: 200px;
        }

        .color-select:focus {
            outline: none;
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        .color-preview {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            border: 2px solid rgba(255,255,255,0.2);
            background: #334155;
            transition: all 0.3s;
        }

        .status {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status.definida {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .status.pendente {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .progress {
            background: #0f172a;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #334155;
            border-radius: 4px;
            margin: 0 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #22c55e);
            transition: width 0.3s;
            border-radius: 4px;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        @media (max-width: 1024px) {
            .sections {
                grid-template-columns: 1fr;
            }
        }

        .cores-disponiveis {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .cores-disponiveis h3 {
            color: #60a5fa;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .cores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .cor-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            font-size: 11px;
            transition: all 0.2s;
        }

        .cor-item:hover {
            background: rgba(255,255,255,0.08);
        }

        .cor-item.usada {
            opacity: 0.3;
            text-decoration: line-through;
        }

        .cor-item-box {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 2px solid rgba(255,255,255,0.2);
            flex-shrink: 0;
        }

        .cor-item-label {
            color: #e2e8f0;
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Seletor de Cores - Archipelago Dashboard</h1>
        <p class="subtitle">Atribua cores para as novas concess√µes e linhas de cuidado</p>

        <div class="progress">
            <div style="min-width: 120px;">
                <strong id="progressText">0/28 selecionadas</strong>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div style="min-width: 100px; text-align: right;">
                <span id="progressPercent">0%</span>
            </div>
        </div>

        <div class="cores-disponiveis">
            <h3>üé® Cores Dispon√≠veis (atualiza em tempo real)</h3>
            <div class="cores-grid" id="coresDisponiveisGrid"></div>
        </div>

        <div class="sections">
            <!-- CONCESS√ïES -->
            <div class="section">
                <h2>üíä CONCESS√ïES (11 itens)</h2>
                <div id="concessoesContainer"></div>
            </div>

            <!-- LINHAS DE CUIDADO -->
            <div class="section">
                <h2>üè• LINHAS DE CUIDADO (45 itens)</h2>
                <div id="linhasContainer"></div>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(34, 197, 94, 0.3);"></div>
                <span>Cor j√° definida</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: rgba(245, 158, 11, 0.3);"></div>
                <span>Precisa selecionar</span>
            </div>
        </div>
    </div>

    <div class="actions">
        <button class="btn btn-secondary" onclick="visualizarResultado()">üëÅÔ∏è Visualizar</button>
        <button class="btn btn-primary" onclick="baixarTXT()">üíæ Baixar TXT</button>
    </div>

    <script>
        // =================== DADOS ===================
        const CONCESSOES = {
            'Transi√ß√£o Domiciliar': '#007A53',
            'Aplica√ß√£o domiciliar de medicamentos': '#582C83',
            'Aspira√ß√£o': '#2E1A47',
            'Banho': '#8FD3F4',
            'Curativo': '#00BFB3',
            'Curativo PICC': '#E03C31',
            'Fisioterapia Domiciliar': '#009639',
            'Fonoaudiologia Domiciliar': '#FF671F',
            'Oxigenoterapia': '#64A70B',
            'Remo√ß√£o': null,
            'Solicita√ß√£o domiciliar de exames': null
        };

        const LINHAS_CUIDADO = {
            'Assiste': '#ED0A72',
            'APS SP': '#007A33',
            'Cuidados Paliativos': '#00B5A2',
            'ICO (Insufici√™ncia Coronariana)': '#A6192E',
            'Nexus SP Cardiologia': null,
            'Nexus SP Gastroentereologia': null,
            'Nexus SP Geriatria': null,
            'Nexus SP Pneumologia': null,
            'Nexus SP Psiquiatria': null,
            'Nexus SP Reumatologia': null,
            'Nexus SP Sa√∫de do F√≠gado': null,
            'Generalista': null,
            'Bucomaxilofacial': null,
            'Cardiologia': null,
            'Cirurgia Card√≠aca': null,
            'Cirurgia de Cabe√ßa e Pesco√ßo': null,
            'Cirurgia do Aparelho Digestivo': null,
            'Cirurgia Geral': null,
            'Cirurgia Oncol√≥gica': null,
            'Cirurgia Pl√°stica': null,
            'Cirurgia Tor√°cica': null,
            'Cirurgia Vascular': null,
            'Cl√≠nica M√©dica': null,
            'Coloproctologia': null,
            'Dermatologia': null,
            'Endocrinologia': null,
            'Fisiatria': null,
            'Gastroenterologia': null,
            'Geriatria': null,
            'Ginecologia e Obstetr√≠cia': null,
            'Hematologia': null,
            'Infectologia': null,
            'Mastologia': null,
            'Nefrologia': null,
            'Neurocirurgia': null,
            'Neurologia': null,
            'Oftalmologia': null,
            'Oncologia Cl√≠nica': '#6A1B9A',
            'Ortopedia': null,
            'Otorrinolaringologia': null,
            'Pediatria': '#5A646B',
            'Pneumologia': null,
            'Psiquiatria': null,
            'Reumatologia': null,
            'Urologia': null
        };

        const CORES_DISPONIVEIS = {
            '#FFB81C': 'Amarelo (Vida Mais Leve)',
            '#C8102E': 'Vermelho (Cr√¥nicos Cardio)',
            '#FF6F1D': 'Laranja (Cr√¥nicos Geriatria)',
            '#556F44': 'Verde oliva (Cr√¥nicos Melhor)',
            '#0072CE': 'Azul (Cr√¥nicos Neurologia)',
            '#E35205': 'Laranja escuro (Cr√¥nicos Pneumo)',
            '#003C57': 'Azul petr√≥leo (Cr√¥nicos P√≥s-bar)',
            '#5A0020': 'Bord√¥ (Cr√¥nicos Reumato)',
            '#5C5EBE': 'Azul roxo (Autoimune Gastro)',
            '#00AEEF': 'Azul (Autoimune Neuro-desm)',
            '#00263A': 'Azul marinho (Autoimune Neuro-musc)',
            '#582D40': 'Roxo escuro (Autoimune Reumato)',
            '#FFC72C': 'Amarelo (Orient Nutric com)',
            '#F4E285': 'Amarelo claro (Orient Nutric sem)',
            '#E8927C': 'Salm√£o (Clister)'
        };

        let coresUsadas = new Set();

        // =================== INICIALIZA√á√ÉO ===================
        function init() {
            // Adicionar cores j√° definidas ao set de usadas
            Object.values(CONCESSOES).forEach(cor => {
                if (cor) coresUsadas.add(cor);
            });
            Object.values(LINHAS_CUIDADO).forEach(cor => {
                if (cor) coresUsadas.add(cor);
            });

            renderizarPaletaCores();
            renderizarConcessoes();
            renderizarLinhas();
            atualizarProgresso();
        }

        // =================== RENDERIZAR PALETA ===================
        function renderizarPaletaCores() {
            const grid = document.getElementById('coresDisponiveisGrid');
            grid.innerHTML = '';

            Object.entries(CORES_DISPONIVEIS).forEach(([hex, descricao]) => {
                const div = document.createElement('div');
                div.className = `cor-item ${coresUsadas.has(hex) ? 'usada' : ''}`;
                div.innerHTML = `
                    <div class="cor-item-box" style="background: ${hex};"></div>
                    <div class="cor-item-label">${descricao}</div>
                `;
                grid.appendChild(div);
            });
        }

        // =================== RENDERIZAR ===================
        function renderizarConcessoes() {
            const container = document.getElementById('concessoesContainer');
            container.innerHTML = '';

            Object.entries(CONCESSOES).forEach(([nome, cor]) => {
                const item = criarItemHTML(nome, cor, 'concessao');
                container.appendChild(item);
            });
        }

        function renderizarLinhas() {
            const container = document.getElementById('linhasContainer');
            container.innerHTML = '';

            Object.entries(LINHAS_CUIDADO).forEach(([nome, cor]) => {
                const item = criarItemHTML(nome, cor, 'linha');
                container.appendChild(item);
            });
        }

        function criarItemHTML(nome, cor, tipo) {
            const div = document.createElement('div');
            div.className = 'item';

            if (cor) {
                // Tem cor definida
                div.innerHTML = `
                    <div class="item-name">${nome}</div>
                    <span class="status definida">‚úì Definida</span>
                    <div class="color-box" style="background: ${cor};">${cor}</div>
                `;
            } else {
                // Precisa selecionar cor
                const selectId = `select_${tipo}_${nome.replace(/\s+/g, '_')}`;
                div.innerHTML = `
                    <div class="item-name">${nome}</div>
                    <span class="status pendente">‚ö† Pendente</span>
                    <div class="color-selector-wrapper">
                        <select class="color-select" id="${selectId}" data-tipo="${tipo}" data-nome="${nome}" onchange="selecionarCor(this)">
                            <option value="">Selecionar cor...</option>
                            ${gerarOpcoesDisponiveis()}
                        </select>
                        <div class="color-preview" id="${selectId}_preview"></div>
                    </div>
                `;
            }

            return div;
        }

        function gerarOpcoesDisponiveis() {
            let options = '';
            Object.entries(CORES_DISPONIVEIS).forEach(([hex, descricao]) => {
                if (!coresUsadas.has(hex)) {
                    options += `<option value="${hex}">${descricao}</option>`;
                }
            });
            return options;
        }

        // =================== SELE√á√ÉO DE COR ===================
        function selecionarCor(select) {
            const tipo = select.dataset.tipo;
            const nome = select.dataset.nome;
            const cor = select.value;

            // Atualizar preview
            const preview = document.getElementById(`${select.id}_preview`);
            if (preview) {
                preview.style.background = cor || '#334155';
            }

            if (!cor) return;

            // Adicionar cor ao set de usadas
            coresUsadas.add(cor);

            // Atualizar o objeto correspondente
            if (tipo === 'concessao') {
                CONCESSOES[nome] = cor;
            } else {
                LINHAS_CUIDADO[nome] = cor;
            }

            // Re-renderizar tudo
            renderizarPaletaCores();
            renderizarConcessoes();
            renderizarLinhas();
            atualizarProgresso();

            // Adicionar listeners aos novos selects
            adicionarListenersPreview();
        }

        // =================== PREVIEW AO HOVER ===================
        function adicionarListenersPreview() {
            document.querySelectorAll('.color-select').forEach(select => {
                select.addEventListener('change', function() {
                    const preview = document.getElementById(`${this.id}_preview`);
                    if (preview) {
                        preview.style.background = this.value || '#334155';
                    }
                });

                // Preview ao passar o mouse nas op√ß√µes
                select.addEventListener('mouseover', function(e) {
                    if (e.target.tagName === 'OPTION' && e.target.value) {
                        const preview = document.getElementById(`${this.id}_preview`);
                        if (preview) {
                            preview.style.background = e.target.value;
                        }
                    }
                });

                select.addEventListener('mouseout', function() {
                    const preview = document.getElementById(`${this.id}_preview`);
                    if (preview) {
                        preview.style.background = this.value || '#334155';
                    }
                });
            });
        }

        // =================== PROGRESSO ===================
        function atualizarProgresso() {
            const totalItens = Object.keys(CONCESSOES).length + Object.keys(LINHAS_CUIDADO).length;
            const itensSelecionados = 
                Object.values(CONCESSOES).filter(c => c !== null).length +
                Object.values(LINHAS_CUIDADO).filter(c => c !== null).length;

            const percentual = Math.round((itensSelecionados / totalItens) * 100);

            document.getElementById('progressText').textContent = `${itensSelecionados}/${totalItens} selecionadas`;
            document.getElementById('progressPercent').textContent = `${percentual}%`;
            document.getElementById('progressFill').style.width = `${percentual}%`;
        }

        // =================== BAIXAR TXT ===================
        function baixarTXT() {
            const pendentes = 
                Object.entries(CONCESSOES).filter(([_, cor]) => cor === null).length +
                Object.entries(LINHAS_CUIDADO).filter(([_, cor]) => cor === null).length;

            if (pendentes > 0) {
                alert(`‚ö†Ô∏è Ainda faltam ${pendentes} cores para selecionar!\n\nPor favor, complete todas as sele√ß√µes antes de baixar o arquivo.`);
                return;
            }

            // Gerar conte√∫do do arquivo
            let conteudo = `===============================================
ARCHIPELAGO DASHBOARD - CONFIGURA√á√ÉO DE CORES
Gerado em: ${new Date().toLocaleString('pt-BR')}
===============================================

üìä RESUMO:
‚Ä¢ Concess√µes: ${Object.keys(CONCESSOES).length} itens
‚Ä¢ Linhas de Cuidado: ${Object.keys(LINHAS_CUIDADO).length} itens
‚Ä¢ Total de cores: ${Object.keys(CONCESSOES).length + Object.keys(LINHAS_CUIDADO).length}

===============================================
üíä CONCESS√ïES
===============================================

const CORES_CONCESSOES = {
`;

            Object.entries(CONCESSOES).forEach(([nome, cor]) => {
                conteudo += `    '${nome}': '${cor}',\n`;
            });

            conteudo += `};\n\n`;
            conteudo += `===============================================\n`;
            conteudo += `üè• LINHAS DE CUIDADO\n`;
            conteudo += `===============================================\n\n`;
            conteudo += `const CORES_LINHAS = {\n`;

            Object.entries(LINHAS_CUIDADO).forEach(([nome, cor]) => {
                conteudo += `    '${nome}': '${cor}',\n`;
            });

            conteudo += `};\n\n`;
            conteudo += `===============================================\n`;
            conteudo += `üìã INSTRU√á√ïES DE USO\n`;
            conteudo += `===============================================\n\n`;
            conteudo += `1. Copie as constantes CORES_CONCESSOES e CORES_LINHAS\n`;
            conteudo += `2. Cole no arquivo: js/app.js (Dashboard)\n`;
            conteudo += `3. Cole no arquivo: index.html (QR Code - JavaScript inline)\n`;
            conteudo += `4. Substitua os arrays existentes pelos novos\n`;
            conteudo += `5. Teste em ambiente de desenvolvimento antes de publicar\n\n`;
            conteudo += `===============================================\n`;
            conteudo += `üé® CORES UTILIZADAS\n`;
            conteudo += `===============================================\n\n`;

            // Listar todas as cores usadas
            const coresUsadasArray = Array.from(coresUsadas).sort();
            coresUsadasArray.forEach(cor => {
                const desc = CORES_DISPONIVEIS[cor] || 'Cor original';
                conteudo += `${cor} - ${desc}\n`;
            });

            conteudo += `\n===============================================\n`;
            conteudo += `‚úÖ ARQUIVO GERADO COM SUCESSO!\n`;
            conteudo += `===============================================\n`;

            // Criar blob e download
            const blob = new Blob([conteudo], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `archipelago_cores_${new Date().getTime()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('‚úÖ Arquivo TXT baixado com sucesso!\n\nVoc√™ pode agora:\n‚Ä¢ Compartilhar com a equipe\n‚Ä¢ Versionar no Git\n‚Ä¢ Copiar o c√≥digo para implementa√ß√£o');
        }

        function visualizarResultado() {
            const pendentes = 
                Object.entries(CONCESSOES).filter(([_, cor]) => cor === null).length +
                Object.entries(LINHAS_CUIDADO).filter(([_, cor]) => cor === null).length;

            const total = Object.keys(CONCESSOES).length + Object.keys(LINHAS_CUIDADO).length;
            const selecionadas = total - pendentes;

            if (pendentes > 0) {
                alert(`üìä Status da Sele√ß√£o:\n\n` +
                      `‚úÖ Completas: ${selecionadas}/${total}\n` +
                      `‚ö†Ô∏è Pendentes: ${pendentes}\n\n` +
                      `Complete todas as sele√ß√µes para baixar o arquivo!`);
            } else {
                alert(`‚úÖ Todas as cores foram selecionadas!\n\n` +
                      `üìä Resumo:\n` +
                      `‚Ä¢ Concess√µes: ${Object.keys(CONCESSOES).length} itens\n` +
                      `‚Ä¢ Linhas de Cuidado: ${Object.keys(LINHAS_CUIDADO).length} itens\n` +
                      `‚Ä¢ Total: ${total} cores definidas\n\n` +
                      `Clique em "Baixar TXT" para exportar!`);
            }
        }

        // =================== INICIAR ===================
        window.addEventListener('load', function() {
            init();
            adicionarListenersPreview();
        });
    </script>
</body>
</html>
